# 创建立方体功能开发 To-Do List

> 本清单依据《产品需求文档.md》中对交互细节的描述整理，按照开发模块划分任务，便于分工与迭代。

## 一、核心基础设施

### 1. 场景与渲染初始化
- [x] 初始化 Cesium 场景（Viewer / Scene / Camera / Renderer）。
- [x] 配置基础光照、地面、坐标轴或网格参考系。
- [x] 支持视图导航（旋转、平移、缩放）且与后续操作模式不冲突。

### 2. 对象管理
- [x] 定义立方体对象抽象（position、rotation、scale、geometry、material）。
- [x] 封装添加 / 移除对象到场景的统一接口。
- [x] 在对象创建、删除时维护全局对象列表及唯一 ID。

### 3. 选取系统
- [x] 基于 Cesium 原生 API 实现鼠标射线拾取并返回命中对象。
- [x] 支持单选与空白区域点击取消选中。
- [x] 选中对象渲染橙色轮廓或 Outline 效果。

### 4. 状态管理
- [x] 建立全局状态机，覆盖 `view / create / translate / rotate / scale` 模式。
- [x] 维护 `selectedObject`、`activeAxis`、`snapMode` 等关键状态。
- [x] 支持状态变化事件派发，供 UI 与操纵器订阅。

## 二、立方体创建流程（高优先级）

### 1. 图形界面创建
- [x] 顶部菜单栏实现 `Add → Mesh → Cube` 三级结构。
- [x] 菜单项悬停高亮、点击态反馈。
- [x] 点击 `Cube` 在默认位置或光标投影位置生成立方体，并自动选中。

### 2. 快捷键创建
- [x] 监听 `Shift + A` 调出添加菜单或直接触发创建面板。
- [x] 支持快捷键序列（如 `Shift + A` → `M` → `C`）。
- [x] 与 GUI 创建共享立方体生成逻辑与选中流程。

### 3. 即时参数面板
- [x] 立方体创建后在左下角弹出参数面板。
- [x] 面板字段：尺寸（Width/Height/Depth）、位置（X/Y/Z），可实时编辑。
- [x] 修改面板数据实时回写立方体属性，支持确认 / 关闭交互。

## 三、变换操纵器与交互

### 1. 操纵器组件
- [x] 实现移动 / 旋转 / 缩放三类 Gizmo，颜色编码 X=红、Y=绿、Z=蓝。
- [x] 操作时显示半透明预览模型（原对象降透明度并支持撤销）。
- [x] 轴向约束高亮当前轴向。

### 2. 移动（`G`）
- [x] 监听 `G` 键触发 `translate` 模式，仅在有选中对象时生效。
- [x] 鼠标拖拽时对象随射线或地平面移动，显示预览。
- [x] `X/Y/Z` 首次约束全局轴，再次切换局部轴。
- [x] `Shift` 控制微调速度，`Ctrl` 启用网格吸附。
- [x] 支持直接数值输入，显示临时文本框，`Enter` 确认、`Esc` / 右键取消。

### 3. 旋转（`R`）
- [x] 监听 `R` 键进入 `rotate` 模式，显示旋转弧线与角度。
- [x] 鼠标拖拽沿选定轴旋转，实时反馈角度数值。
- [x] `Ctrl` 启用 5° 增量，并吸附 15° / 30° / 45° / 90° 常用角度。
- [x] 支持直接输入角度数值。

### 4. 缩放（`S`）
- [x] 监听 `S` 键进入 `scale` 模式。
- [x] 默认均匀缩放；`S + X/Y/Z` 执行单轴缩放。
- [x] 支持保持比例选项（锁定其他轴的比例关系）。
- [x] 支持直接输入缩放倍率或目标尺寸。

## 四、数值精确控制（中优先级）

### 1. 操作内输入
- [x] 在 `G/R/S` 操作期间捕获键盘输入。
- [x] 构建浮动数值输入框，显示当前输入。
- [x] 数值确认后立即应用到当前变换。

### 2. 属性面板（`N` 面板）
- [x] 监听 `N` 键切换右侧属性面板显隐。
- [x] Transform 区展示位置、旋转、缩放数值。
- [x] 编辑数值实时更新对象；未选中对象时显示占位提示。

### 3. 对象属性编辑器
- [x] 提供更详细参数（材质、分段等）配置入口。
- [x] 支持多对象批量编辑策略或只读提醒。


## 五、视觉反馈体系

- [x] 对象选中：橙色轮廓或描边实现。
- [x] 操作进行中：原物体半透明 + 操纵器提示。
- [x] 轴向约束：轴颜色高亮，非激活轴半透明。
- [x] 数值输入：浮动文本框显示输入、确认状态提示。

## 六、高级交互（低优先级）

### 1. 编辑模式
- [x] 模式切换（对象 / 编辑）。
- [x] 顶点 (`1`)、边 (`2`)、面 (`3`) 选择模式及高亮反馈。
- [x] 在编辑模式中支持变换与 Proportional Editing 对接。

### 2. 衰减编辑（`O`）
- [x] `O` 键切换衰减编辑开关。
- [x] 鼠标滚轮调整影响半径并显示衰减圈。
- [x] 变换时按距离衰减影响周围顶点。

### 3. 修改器堆栈
- [x] 属性面板中实现修改器列表（添加 / 启用 / 禁用 / 折叠）。
- [x] 支持常见修改器（细分、布尔等）参数配置。
- [x] 修改器顺序可调整并实时反馈。


## 七、特殊场景处理

- [x] 透视选择（X-Ray）模式：提供快捷键和 UI 指示。
- [x] 选择过滤：按对象类型筛选可选目标。
- [x] 操作期间仍可执行视图导航（中键旋转、Alt+中键平移等）。


## 里程碑建议

1. **基础能力**：完成核心基础设施模块。
2. **核心体验**：实现立方体创建与 G/R/S 变换。
3. **体验增强**：补齐数值控制与视觉反馈。
4. **高级功能**：实现编辑模式、修改器堆栈与特殊场景支持。

